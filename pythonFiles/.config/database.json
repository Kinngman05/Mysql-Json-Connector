{
    "databases": {
        "rail_test_db": {
            "tables": {
                "studs": {
                    "table_constrains": {
                        "usn": "CHAR(10) NOT NULL",
                        "rail_id": "CHAR(10) NOT NULL",
                        "student_name": "VARCHAR(100) NOT NULL",
                        "gender": "CHAR(1) NOT NULL",
                        "date_of_birth": "DATE NOT NULL",
                        "time_of_joining_rail": "DATETIME NOT NULL DEFAULT NOW()",
                        "phone_number": "VARCHAR(10) NOT NULL",
                        "email": "VARCHAR(40) NOT NULL",
                        "projects_done": "INT(3) UNSIGNED NOT NULL DEFAULT 0",
                        "branch": "CHAR(2) NOT NULL",
                        "login_status": "ENUM('YES','NO') NOT NULL DEFAULT 'NO'",
                        "component_status": "ENUM('YES','NO') NOT NULL DEFAULT 'NO'",
                        "most_recent_login": "DATETIME DEFAULT NULL",
                        "time_in_rail": "TIME NOT NULL DEFAULT '00:00:00'",
                        "current_role": "ENUM('MEMBER','TEAM_LEAD') NOT NULL",
                        "review_dt_type": "ENUM('GOOD','AVERAGE','BAD') DEFAULT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "rail_id"
                        ],
                        [
                            "phone_number"
                        ],
                        [
                            "email"
                        ],
                        [
                            "usn"
                        ]
                    ],
                    "primary_key": "usn",
                    "foreign_key": null
                },
                "teams": {
                    "table_constrains": {
                        "team_hash": "CHAR(6) NOT NULL",
                        "team_name": "VARCHAR(30) NOT NULL",
                        "number_of_members": "TINYINT UNSIGNED NOT NULL",
                        "date_of_team_creation": "DATE NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "team_hash"
                        ]
                    ],
                    "primary_key": "team_hash",
                    "foreign_key": null
                },
                "projs": {
                    "table_constrains": {
                        "project_id": "CHAR(10) NOT NULL",
                        "team_hash": "CHAR(8) NOT NULL",
                        "project_name": "VARCHAR(30) NOT NULL",
                        "project_description": "VARCHAR(200) NOT NULL",
                        "mentor": "VARCHAR(50)",
                        "guide": "VARCHAR(50)",
                        "idea_by": "VARCHAR(50) NOT NULL",
                        "type_of_project": "VARCHAR(30) NOT NULL",
                        "expected_duration": "VARCHAR(20) NOT NULL",
                        "date_start": "DATE NOT NULL",
                        "date_end": "DATE",
                        "project_lead": "CHAR(10) NOT NULL",
                        "status": "VARCHAR(20) NOT NULL",
                        "priority": "VARCHAR(20) NOT NULL",
                        "project_man_hours": "TIME NOT NULL DEFAULT '00:00:00'",
                        "technology_stack": "VARCHAR(50) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": "project_id",
                    "foreign_key": [
                        {
                            "constraint_name": null,
                            "foreign_table_name": "teams",
                            "child_attribute": [
                                "team_hash"
                            ],
                            "parent_attribute": [
                                "team_hash"
                            ]
                        }
                    ]
                },
                "studs_and_teams_mapping_table": {
                    "table_constrains": {
                        "team_hash": "CHAR(6) NOT NULL",
                        "rail_id": "CHAR(10) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "team_hash",
                            "rail_id"
                        ]
                    ],
                    "primary_key": null,
                    "foreign_key": [
                        {
                            "constraint_name": null,
                            "foreign_table_name": "teams",
                            "child_attribute": [
                                "team_hash"
                            ],
                            "parent_attribute": [
                                "team_hash"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "studs",
                            "child_attribute": [
                                "rail_id"
                            ],
                            "parent_attribute": [
                                "rail_id"
                            ]
                        }
                    ]
                },
                "all_purposes": {
                    "table_constrains": {
                        "purpose": "CHAR(10) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": "purpose",
                    "foreign_key": null
                },
                "attendance": {
                    "table_constrains": {
                        "rail_id": "CHAR(10) NOT NULL",
                        "team_hash": "CHAR(6) NOT NULL ",
                        "time_in": "DATETIME NOT NULL DEFAULT NOW()",
                        "time_out": "DATETIME DEFAULT NULL",
                        "time_spent": "TIME DEFAULT NULL",
                        "purpose": "CHAR(10) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": null,
                    "foreign_key": [
                        {
                            "constraint_name": null,
                            "foreign_table_name": "studs",
                            "child_attribute": [
                                "rail_id"
                            ],
                            "parent_attribute": [
                                "rail_id"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "teams",
                            "child_attribute": [
                                "team_hash"
                            ],
                            "parent_attribute": [
                                "team_hash"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "all_purposes",
                            "child_attribute": [
                                "purpose"
                            ],
                            "parent_attribute": [
                                "purpose"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "studs_and_teams_mapping_table",
                            "child_attribute": [
                                "team_hash",
                                "rail_id"
                            ],
                            "parent_attribute": [
                                "team_hash",
                                "rail_id"
                            ]
                        }
                    ]
                },
                "staff": {
                    "table_constrains": {
                        "name": "VARCHAR(50) NOT NULL",
                        "staff_id": "VARCHAR(10)  ",
                        "date_of_birth": "DATETIME DEFAULT NULL",
                        "date_of_account_creation": "DATETIME NOT NULL",
                        "phone_number": "CHAR(10) NOT NULL",
                        "email": "VARCHAR(50) NOT NULL",
                        "password": "VARCHAR(20) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "email"
                        ]
                    ],
                    "primary_key": "staff_id",
                    "foreign_key": null
                },
                "staff_attendance": {
                    "table_constrains": {
                        "admin_id": "VARCHAR(10) NOT NULL",
                        "time_in": "DATETIME NOT NULL DEFAULT NOW()",
                        "time_out": "DATETIME DEFAULT NULL",
                        "time_spent": "TIME DEFAULT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "admin_id"
                        ]
                    ],
                    "primary_key": null,
                    "foreign_key": null
                },
                "events": {
                    "table_constrains": {
                        "rail_id": "CHAR(10) NOT NULL",
                        "event_id": "CHAR(10) NOT NULL",
                        "time_of_event": "DATETIME  ",
                        "type": "VARCHAR(30) NOT NULL",
                        "topic": "VARCHAR(70) NOT NULL",
                        "description": "VARCHAR(200) NOT NULL",
                        "domain": "VARCHAR(20) NOT NULL",
                        "member_type": "VARCHAR(30) NOT NULL",
                        "duration": "TIME NOT NULL",
                        "by_who": "VARCHAR(30) NOT NULL",
                        "phone_number": "CHAR(10)",
                        "email": "VARCHAR(50)",
                        "number_of_attendees": "INT(3) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": "event_id",
                    "foreign_key": null
                },
                "components": {
                    "table_constrains": {
                        "component_id": "CHAR(10) NOT NULL",
                        "component_name": "VARCHAR(60) NOT NULL",
                        "date_of_procurement": "DATE NOT NULL",
                        "if_kit": "ENUM('YES','NO') NOT NULL DEFAULT 'NO'",
                        "associated_colour": "VARCHAR(20) NOT NULL",
                        "number_of_times_issued": "INT UNSIGNED NOT NULL DEFAULT '0'",
                        "group": "VARCHAR(20) NOT NULL",
                        "component_status": "ENUM('YES','NO') NOT NULL DEFAULT 'NO'",
                        "most_recent_issue": "DATETIME DEFAULT NULL",
                        "total_time_of_use": "TIME NOT NULL DEFAULT '00:00:00'"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": "component_id",
                    "foreign_key": null
                },
                "kits": {
                    "table_constrains": {
                        "kit_id": "CHAR(10) NOT NULL",
                        "component_id": "CHAR(10) NOT NULL",
                        "number_of_sub_components": "INT(3) UNSIGNED NOT NULL",
                        "sub_components": "BLOB NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": [
                        [
                            "component_id"
                        ]
                    ],
                    "primary_key": "kit_id",
                    "foreign_key": [
                        {
                            "constraint_name": null,
                            "foreign_table_name": "components",
                            "child_attribute": [
                                "component_id"
                            ],
                            "parent_attribute": [
                                "component_id"
                            ]
                        }
                    ]
                },
                "iss_compnts": {
                    "table_constrains": {
                        "component_id": "CHAR(10) NOT NULL",
                        "issued_to": "VARCHAR(10) NOT NULL",
                        "team_hash": "CHAR(6) NOT NULL",
                        "time_of_issue": "DATETIME NOT NULL DEFAULT NOW()",
                        "time_of_return": "DATETIME",
                        "time_of_use": "TIME",
                        "project_id": "CHAR(10) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": null,
                    "foreign_key": [
                        {
                            "constraint_name": null,
                            "foreign_table_name": "components",
                            "child_attribute": [
                                "component_id"
                            ],
                            "parent_attribute": [
                                "component_id"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "projs",
                            "child_attribute": [
                                "project_id"
                            ],
                            "parent_attribute": [
                                "project_id"
                            ]
                        },
                        {
                            "constraint_name": null,
                            "foreign_table_name": "teams",
                            "child_attribute": [
                                "team_hash"
                            ],
                            "parent_attribute": [
                                "team_hash"
                            ]
                        }
                    ]
                },
                "rail_donors": {
                    "table_constrains": {
                        "rail_id": "CHAR(10) NOT NULL",
                        "amount": "INT NOT NULL",
                        "time": "DATETIME DEFAULT NOW()",
                        "reason": "VARCHAR(20) NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": null,
                    "foreign_key": null
                },
                "rail_expenses": {
                    "table_constrains": {
                        "item_purchased": "VARCHAR(25) NOT NULL",
                        "quantity": "INT DEFAULT 1",
                        "date_of_purchase": "DATE NOT NULL",
                        "component_id": "CHAR(10) NOT NULL",
                        "company": "VARCHAR(20)",
                        "cost": "INT NOT NULL"
                    },
                    "read_list": null,
                    "index_constrains": null,
                    "primary_key": null,
                    "foreign_key": null
                }
            }
        }
    },
    "procedures": [
        {
            "procedure_name": "update_studs_most_recent_login",
            "procedure_parameters": [
                "IN id CHAR(10)",
                "IN time DATETIME"
            ],
            "procedures": "UPDATE studs SET most_recent_login=time WHERE rail_id=id;"
        },
        {
            "procedure_name": "set_login_status_to_True",
            "procedure_parameters": [
                "IN id CHAR(10)"
            ],
            "procedures": "UPDATE studs SET login_status=TRUE WHERE rail_id=id;"
        },
        {
            "procedure_name": "set_login_status_to_False",
            "procedure_parameters": [
                "IN id CHAR(10)"
            ],
            "procedures": "UPDATE studs SET login_status=FALSE WHERE rail_id=id;"
        }
    ],
    "triggers": [
        {
            "trigger_name": "projs_BEFORE_INSERT",
            "trigger_time": "BEFORE INSERT",
            "database_name": "rail_test_db",
            "table_name": "projs",
            "queries": [
                "INSERT INTO all_purposes SET purpose = NEW.project_id;"
            ]
        },
        {
            "trigger_name": "events_BEFORE_INSERT",
            "trigger_time": "BEFORE INSERT",
            "database_name": "rail_test_db",
            "table_name": "events",
            "queries": [
                "INSERT INTO all_purposes SET purpose = NEW.event_id;"
            ]
        },
        {
            "trigger_name": "events_AFTER_INSERT",
            "trigger_time": "AFTER INSERT",
            "database_name": "rail_test_db",
            "table_name": "attendance",
            "queries": [
                "CALL update_studs_most_recent_login(NEW.rail_id,NEW.time_in);",
                "CALL set_login_status_to_True(NEW.rail_id);"
            ]
        },
        {
            "trigger_name": "attendance_BEFORE_UPDATE",
            "trigger_time": "BEFORE UPDATE",
            "database_name": "rail_test_db",
            "table_name": "attendance",
            "queries": [
                "IF OLD.time_spent IS NULL THEN SET NEW.time_spent=TIMEDIFF(NEW.time_out,OLD.time_in); END IF;",
                "CALL set_login_status_to_False(NEW.rail_id);"
            ]
        }
    ]
}